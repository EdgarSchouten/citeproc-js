# TODO

## Completion of feature set

- Erratum: unparsed dates.  The input object for dates
  should include a "literal" attribute, which renders
  instead of the formatted date if the "year" attribute
  is nil.

- Erratum: raw date variables.  These should render as
  2000-12-01 when they appear as the argument to a text
  element.  Important for sort keys, as the raw variable
  is used all over the place in existing styles.
    (awaits test submission.  fbennett 2009-05-18)

- Erratum: suppression of elements.  Doesn't seem to be
  any mechanism in place for restraining variables from
  rendering more than once in a citation.  The mark_output
  function should be extended to support this, with an
  appropriate hook in the output queue (?).
    (awaits test submission.  fbennett 2009-05-18)

- Erratum: all spanned top-level elements within
  a substitute span need to be treated as well-behaved
  conditionals, setting the substitute rendering flag to
  false if they render something, and skipping unless
  that value is true.  This will require (a) that the
  code to cast these elements with appropriate conditional
  wrappers be refactored as a discrete function, and
  (b) that the output queue itself set a return value somewhere
  to indicate whether or not something rendered.
    (awaits test submission.  fbennett 2009-05-18)

- Handle position evaluation and back-references inside the 
  processor via the registry.  Zotero's own position evaluation 
  is currently broken, and although it may be fixed soon, demanding 
  complex evaluation like this is likely to lead to further trouble 
  in other applications.  If the processor receives the note number 
  from the application, the CSL processor can take care of the rest.
  First step will be to draw my positioning patches to
  integration.js into the citeproc-js code base, and figure out
  how to stitch it in via an extension to the registry.
  NOTE: this is on hold pending guidance from Zotero on (a) whether
  this functionality is desirable, and (b) whether it is possible
  to receive note numbers and predecessors from the plugins on
  each transaction.  In any case, not to be implemented until
  the specifics of the transaction protocol are known.
    (pending fbennett 2009-04-17)

- Various options and special formatting attributes need to be
  implemented, none of which seem particularly scarey.
    (a very short list of these remain.  fbennett 2009-04-11)


## Possible work for Zotero deployment

- Anything on which I receive guidance.  No requests
  pending at present.
    (fbennett 2009-05-18)


## Possible proposals for CSL

- Number could be a span element with per-atom formatting, 
  as has been done with names.  This will allow superscripting
  or ordinal suffixes, and maybe some other useful things.
    (pending.  fbennett 2009-04-13)

- Localized date formatting?
    (pending.  fbennett 2009-04-11)
